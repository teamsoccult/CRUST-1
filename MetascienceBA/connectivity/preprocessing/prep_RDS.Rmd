---
title: "Centrality"
author: "Mikkel Werling"
date: "11/23/2019"
output: html_document
---
```{r}

##NEED TO ALSO INCLUDE COLAB CONDITIONS!! - should be very doable though

setwd("D:/data_new1")

replica <- 1:50

#readRDS

temp = list.files(pattern="^TOM.*.rds")

centrality <- function(temp){
  
  datalist1 <- list()
  datalist2 <- list()
  
  test = lapply(temp, readRDS)

for(i in (1:length(temp))){
#all in one
  for(j in (1:length(replica))){
df <- as.data.frame(test[[i]][[j]][1:6], col.names = c("true_model", "base_SS", "sigma", "network", "net_size", "population"))
  
df$replica <- j

g <- graph_from_adjacency_matrix(test[[i]][[j]][[7]], diag = F, mode = "undirected")

V(g)$type <- gsub("\\..*","",V(g)$name)

df_test <- data.frame(unname(degree(g)))

df_test$closeness <- closeness(g)

df_test$types <- gsub("\\..*","", names(degree(g)))

difference <- df_test %>%
  group_by(types) %>%
  summarize(mean_degree = mean(unname.degree.g..),
            mean_closeness = mean(closeness))

difference <- difference %>%
  mutate(true_model = df$true_model,
         base_ss = df$base_SS,
         sigma = df$sigma,
         network = df$network,
         net_size = df$net_size,
         population = df$population,
         replica = df$replica)

datalist1[j] <- list(difference)
  }
  datalist2[i] <- list(datalist1)
  
}
  df_final <- do.call("rbind", datalist2)
  
  df_yes <- do.call("rbind", df_final)
  
  return(df_yes)
}

##CONSIDER SPREADING THE DATA IN THE FUNCTION - IE CHECK "DIFFERENCE" BEFORE MUTATE

```

One could consider also writing this csv, which would be trivial. Right now, we just get the df out in return. 
