---
title: "TAT_TAT50"
author: "Victor MÃ¸ller"
date: "26 maj 2019"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Set working directory & load libraries. 

```{r}

setwd("D:/data/data_outcome_measures")
library(tidyverse)

```

Loading & Early prep

```{r}

#reading stuff
TAT_ORIG <- read_csv("TAT_TAT50_Devezer_original.csv")
TAT_FIXED <- read_csv("TAT_TAT50_Devezer_fixed.csv")

#as factor
factorize <- function(dataframe){
  df <- dataframe %>%
    mutate(network = factor(network),
         population = factor(population),
         sigma = factor(sigma),
         true_model = factor(true_model),
         base_SS = factor(base_SS),
         modelcompare = factor(modelcompare))
  
  return(df)
}

TAT_ORIG <- factorize(TAT_ORIG)
TAT_FIXED <- factorize(TAT_FIXED)

```

Main effects: 

```{r}

#Function approach
TAT_FX <- function(.df, .grouping){

  grouping <- enquo(.grouping)
  
  df <- .df %>%
  group_by(UQ(grouping)) %>%
  summarize(TAT_median = median(TAT),
            TAT_mean = mean(TAT),
            TAT_IQR = IQR(TAT),
            TAT_SD = sd(TAT))
  
  return(df)
  
}

##FOR ORIGINAL DEVEZER ##

colnames(TAT_ORIG) 

#TATS
TAT_POP_ORIG <- TAT_FX(TAT_ORIG, population) #what we write. 
TAT_FX(TAT_ORIG, sigma)
TAT_FX(TAT_ORIG, true_model)
TAT_FX(TAT_ORIG, base_SS)
TAT_FX(TAT_ORIG, modelcompare)

##FOR FIXED DEVEZER ##

colnames(TAT_FIXED) 

#TATS
TAT_POP_FIXED <- TAT_FX(TAT_FIXED, population) #what we write. 
TAT_FX(TAT_FIXED, sigma)
TAT_FX(TAT_FIXED, true_model)
TAT_FX(TAT_FIXED, base_SS)
TAT_FX(TAT_FIXED, modelcompare)
```

Interaction effects: 

```{r}

#Function approach
TAT_FX2 <- function(.df, ...){

  group_var <- enquos(...)
  
  df <- .df %>%
  group_by(!!! group_var) %>%
  summarize(TAT_median = round(median(TAT),2),
            TAT_mean = round(mean(TAT),2),
            TAT_IQR = round(IQR(TAT),2),
            TAT50_median = round(median(TAT50),2),
            TAT50_mean = round(mean(TAT50),2),
            TAT50_IQR = round(IQR(TAT50),2))
  
  return(df)
  
}

## FOR ORIGINAL DEVEZER ## 

#overview
colnames(TAT_ORIG)

#interactions
SIGMOD <- TAT_FX2(TAT_ORIG, sigma, true_model) #clear interaction 
SIGPOP <- TAT_FX2(TAT_ORIG, sigma, population) #nothing conclusive
POPMOD <- TAT_FX2(TAT_ORIG, population, true_model) #nothing conclusive

## FOR FIXED ##

#overview
colnames(TAT_ORIG)

#interactions
SIGMOD <- TAT_FX2(TAT_FIXED, sigma, true_model) #clear interaction 
SIGPOP <- TAT_FX2(TAT_FIXED, sigma, population) #nothing conclusive
POPMOD <- TAT_FX2(TAT_FIXED, population, true_model) #nothing conclusive

```

write csv 

```{r}

setwd("~/CRUST-1/DevezerAlteredAgents/src/KableTable")
write_csv(TAT_POP_ORIG, "TAT_POP_ORIG.csv")
write_csv(TAT_POP_FIXED, "TAT_POP_FIXED.csv")


```

