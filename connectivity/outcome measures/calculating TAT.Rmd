---
title: "calculating"
author: "Mikkel Werling & Victor Møller"
date: "5/18/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Set working directory & load libraries. 

```{r}

setwd("C:/Users/victm/Dropbox/CogSci 4/Social and Cultural Dynamics in Cognition/exam/CRUST-1/data/ABMdata/ABMcsv")

library(tidyverse)

```

Read file. 
Network: small world 
Sample Size: 100
True model: 7

```{r}

small <- read.csv("small_100_m7.csv")

```

Calculating TAT (total time)
Not grouped by sigma (could be revised).
NB: proportion needs to be set to the true model (in this case 7). 

```{r}

#Setting the true model
small <- small %>%
  mutate(proportion_true = proportion_7)

#TAT
TAT <- small %>%  #set the true model
  group_by(replica, network, population) %>% #could be sigma as well
  summarise(mean = mean(proportion_true)) 

#TAT summarized
TAT_sum <- TAT %>%
  group_by(network, population) %>%
  summarize(median = median(mean),
            IQR = IQR(mean))

```

calculating TAT_C:

```{r}

#checking when proportion is greatest. 
logic <- as.data.frame(small$proportion_true > small[,c(4:17, 23)])
logic <- as.data.frame(apply(logic, 2, FUN = as.integer))

#mutating 1 for TAT_c & 0 for not TAT_c
TAT_c <- small %>%
  mutate(TAT_C = ifelse(rowSums(logic) == 13, 1, 0))
  
#per pop, network & replica
TAT_C_table <- TAT_c %>%
  group_by(replica, population, network) %>%
  summarise(mean = mean(TAT_C)) 

#summary stats
TAT_C_table_inc <- TAT_C_table %>%
  group_by(population, network) %>%
  summarize(median = median(mean),
          IQR = IQR(mean))

```

TAT_50:
I would like to base this on proportion_true for the future. 

```{r}

TAT_50 <- small %>%
  mutate(TAT_50 = ifelse(proportion_true >= 0.5, 1, 0))

TAT_50_table <- TAT_50 %>%
  group_by(replica, population, network) %>%
  summarise(mean = mean(TAT_50)) 

TAT_50_table_inc <- TAT_50_table %>%
  group_by(population, network) %>%
  summarize(median = median(mean),
          IQR = IQR(mean))

```

write csv. 

```{r}
#new working directory
setwd("C:/Users/victm/Dropbox/CogSci 4/Social and Cultural Dynamics in Cognition/exam/CRUST-1/connectivity/results")

#save 
write.csv(TAT_sum, file = "TAT_P_small.csv", row.names = FALSE)
write.csv(TAT_50_table_inc, file = "TAT_50_small.csv", row.names = FALSE)
write.csv(TAT_C_table_inc, file = "TAT_C_small.csv", row.names = FALSE)

#clear environment
rm(list=ls())

```

Read file. 
Network: small world 
Sample Size: 100
True model: 7

```{r}
lattice <- read.csv("lattice_100_m7.csv")

```


Calculating TAT (total time)
Not grouped by sigma (could be revised).
NB: proportion needs to be set to the true model (in this case 7). 

```{r}
#Setting the true model
lattice <- lattice %>%
  mutate(proportion_true = proportion_7)

#TAT
TAT <- lattice %>%  #set the true model
  group_by(replica, network, population) %>% #could be sigma as well
  summarise(mean = mean(proportion_true)) #summarise 

#TAT summarized
TAT_sum <- TAT %>%
  group_by(network, population) %>%
  summarize(median = median(mean),
            IQR = IQR(mean))

```

calculating TAT_C:
I would like to base this on proportion_true for the future. 

```{r}

#checking when proportion is greatest. 
logic <- as.data.frame(lattice$proportion_true > lattice[,c(4:17, 23)])
logic <- as.data.frame(apply(logic, 2, FUN = as.integer))

#mutating 1 for TAT_c & 0 for not TAT_c
TAT_c <- lattice %>%
  mutate(TAT_C = ifelse(rowSums(logic) == 13, 1, 0))
  
#per pop, network & replica
TAT_C_table <- TAT_c %>%
  group_by(replica, population, network) %>%
  summarise(mean = mean(TAT_C)) 

#summary stats
TAT_C_table_inc <- TAT_C_table %>%
  group_by(population, network) %>%
  summarize(median = median(mean),
          IQR = IQR(mean))

```

TAT_50:

```{r}

TAT_50 <- lattice %>%
  mutate(TAT_50 = ifelse(proportion_true >= 0.5, 1, 0))

TAT_50_table <- TAT_50 %>%
  group_by(replica, population, network) %>%
  summarise(mean = mean(TAT_50)) 

TAT_50_table_inc <- TAT_50_table %>%
  group_by(population, network) %>%
  summarize(median = median(mean),
          IQR = IQR(mean))

```

Saving 

```{r}
#new working directory
setwd("C:/Users/victm/Dropbox/CogSci 4/Social and Cultural Dynamics in Cognition/exam/CRUST-1/connectivity/results")

#save 
write.csv(TAT_sum, file = "TAT_P_lattice.csv", row.names = FALSE)
write.csv(TAT_50_table_inc, file = "TAT_50_lattice.csv", row.names = FALSE)
write.csv(TAT_C_table_inc, file = "TAT_C_lattice.csv", row.names = FALSE)

```

