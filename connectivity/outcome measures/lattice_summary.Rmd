---
title: "Untitled"
author: "Victor MÃ¸ller"
date: "19 maj 2019"
output: html_document
---


```{r setup, include=FALSE}

#working directory 
setwd("C:/Users/victm/Dropbox/CogSci 4/Social and Cultural Dynamics in Cognition/exam/CRUST-1/connectivity/results")

#clearing & reading 
temp <- list.files(pattern="*.csv")

#making rownames
a <- data.frame(name=c("Proportion of time at true model", 
                      "Proportion of time with true majority", 
                      "Proportion of time at true model > 50%",
                      "Replication rate",
                      "Replication rate if true model"), 
                b=1:5,
                c=1:5,
                d=1:5)

```

reading lattice world

```{r}
#only lattice world 
names(temp) <- list.files(pattern=".csv")
y <- c("RR_overall_lattice.csv",
       "RR_true_lattice.csv", #this is fucked. 
       "TAT_50_lattice.csv",
       "TAT_C_lattice.csv",
       "TAT_P_lattice.csv")

temp1 <- temp[y]
#reading 
for(i in 1:length(temp1)) assign(temp1[i], read.csv(temp1[i], sep = ","))


```

organizing lattice world median

```{r}
RR_overall_lattice_med <- RR_overall_lattice.csv %>%
  select(population, median) %>%
  spread(population, median) %>%
  rename(Bo = "bo", All = "epi", Mave = "mave", Tess = "tess")

RR_true_lattice_med <- RR_true_lattice.csv %>%
  select(population, median) %>%
  spread(population, median) %>%
  rename(Bo = "bo", All = "epi", Mave = "mave", Tess = "tess")

TAT_50_lattice_med <- TAT_50_lattice.csv %>%
  select(population, median) %>%
  spread(population, median) %>%
  rename(Bo = "bo", All = "epi", Mave = "mave", Tess = "tess")

TAT_C_lattice_med <- TAT_C_lattice.csv %>%
  select(population, median) %>%
  spread(population, median) %>%
  rename(Bo = "bo", All = "epi", Mave = "mave", Tess = "tess")

TAT_P_lattice_med <- TAT_P_lattice.csv %>%
  select(population, median) %>%
  spread(population, median) %>%
  rename(Bo = "bo", All = "epi", Mave = "mave", Tess = "tess")

#rbinding 
lattice_med <- rbind(TAT_P_lattice_med,
                   TAT_C_lattice_med,
                   TAT_50_lattice_med,
                   RR_overall_lattice_med,
                   RR_true_lattice_med)

#times 100
lattice_med <- lattice_med %>%
  mutate(Bo = round(Bo*100, 2),
         All = round(All*100, 2),
         Mave = round(Mave*100, 2),
         Tess = round(Tess*100, 2)) 
  

rownames(lattice_med) <- a$name

#kable - too much space 
lattice_med %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", 
                                      "hover", 
                                      "condensed", 
                                      "responsive"),
                full_width = F) %>%
  add_header_above(c("", "Lattice & Median" = 4))



```

reading lattice world

```{r}

rm(list=setdiff(ls(), c("a", "temp")))

#only lattice world 

names(temp) <- list.files(pattern=".csv")

y <- c("RR_overall_lattice.csv",
       "RR_true_lattice.csv", #this is fucked. 
       "TAT_50_lattice.csv",
       "TAT_C_lattice.csv",
       "TAT_P_lattice.csv")

temp1 <- temp[y]

#reading 
for(i in 1:length(temp1)) assign(temp1[i], read.csv(temp1[i], sep = ","))


```

organizing lattice world IQR

```{r}
RR_overall_lattice_IQR <- RR_overall_lattice.csv %>%
  select(population, IQR) %>%
  spread(population, IQR) %>%
  rename(Bo = "bo", All = "epi", Mave = "mave", Tess = "tess")

RR_true_lattice_IQR <- RR_true_lattice.csv %>%
  select(population, IQR) %>%
  spread(population, IQR) %>%
  rename(Bo = "bo", All = "epi", Mave = "mave", Tess = "tess")

TAT_50_lattice_IQR <- TAT_50_lattice.csv %>%
  select(population, IQR) %>%
  spread(population, IQR) %>%
  rename(Bo = "bo", All = "epi", Mave = "mave", Tess = "tess")

TAT_C_lattice_IQR <- TAT_C_lattice.csv %>%
  select(population, IQR) %>%
  spread(population, IQR) %>%
  rename(Bo = "bo", All = "epi", Mave = "mave", Tess = "tess")

TAT_P_lattice_IQR <- TAT_P_lattice.csv %>%
  select(population, IQR) %>%
  spread(population, IQR) %>%
  rename(Bo = "bo", All = "epi", Mave = "mave", Tess = "tess")

lattice_IQR <- rbind(TAT_P_lattice_IQR,
                   TAT_C_lattice_IQR,
                   TAT_50_lattice_IQR,
                   RR_overall_lattice_IQR,
                   RR_true_lattice_IQR)

#times 100
lattice_IQR <- lattice_IQR %>%
  mutate(Bo = round(Bo*100, 2),
         All = round(All*100, 2),
         Mave = round(Mave*100, 2),
         Tess = round(Tess*100, 2)) 
  

rownames(lattice_IQR) <- a$name

#kable 
library(knitr)
library(kableExtra)

#actual plot
lattice_IQR %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped",
                                      "hover", 
                                      "condensed", 
                                      "responsive"),
                full_width = F) %>%
  add_header_above(c("", "Lattice & IQR" = 4))

```
