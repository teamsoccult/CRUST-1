---
title: "network_comparison"
author: "Mikkel Werling"
date: "11/3/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Document for analyzing the differences in the networks primarily in terms of their degree. 
Here the mean should be especially noteworthy, as the two real networks are scale_free, resulting in some agents with extreme degrees. 
The first insight here is that it probably makes sense to allow all agents in the idealized networks to start with 3 neighbors on both sides to make them more comparable to their real counterparts.

Updated last: 03/11/2019

What the hell is a scale-free network?
```{r}
scale_free_1 <- sample_pa(net_size, directed = F, m = 1)

scale_free_2 <- sample_pa(net_size, directed = F, m = 2)

scale_free_3 <- sample_pa(net_size, directed = F, m = 3)

g1 <- ggraph(scale_free_1, "kk")+
  geom_node_point(aes(size = degree(scale_free_1), alpha = degree(scale_free_1)))+
  geom_edge_fan(alpha = 0.2)+
  theme_graph()

g2 <- ggraph(scale_free_2, "kk")+
  geom_node_point(aes(size = degree(scale_free_2), alpha = degree(scale_free_2)))+
  geom_edge_fan(alpha = 0.2)+
  theme_graph()

g3 <- ggraph(scale_free_3, "kk")+
  geom_node_point(aes(size = degree(scale_free_3), alpha = degree(scale_free_3)))+
  geom_edge_fan(alpha = 0.2)+
  theme_graph()

plot_grid(g1, g2, g3)

min(degree(scale_free_1))

min(degree(scale_free_2))

min(degree(scale_free_3))

### TAKE AWAY: 
### The minimum degree is equal to the constant m, as there will be added 3 extra edges per timestep. 

##PLAYING AROUND WITH POWER:

scale_free_1 <- sample_pa(net_size, directed = F, m = 2, power = 1)

scale_free_2 <- sample_pa(net_size, directed = F, m = 2, power = 2)

scale_free_3 <- sample_pa(net_size, directed = F, m = 2, power = 3)

g1 <- ggraph(scale_free_1, "kk")+
  geom_node_point(aes(size = degree(scale_free_1), alpha = degree(scale_free_1)))+
  geom_edge_fan(alpha = 0.2)+
  theme_graph()

g2 <- ggraph(scale_free_2, "kk")+
  geom_node_point(aes(size = degree(scale_free_2), alpha = degree(scale_free_2)))+
  geom_edge_fan(alpha = 0.2)+
  theme_graph()

g3 <- ggraph(scale_free_3, "kk")+
  geom_node_point(aes(size = degree(scale_free_3), alpha = degree(scale_free_3)))+
  geom_edge_fan(alpha = 0.2)+
  theme_graph()

plot_grid(g1, g2, g3)

min(degree(scale_free_1))

min(degree(scale_free_2))

min(degree(scale_free_3))

## as is evident, there is still a floor to the minimum degree set by the constant m. However, power levels should be kept at 1 (linear), so as to not completely ruin the networks. 
```



Checking how the different networks match up:

```{r}
##Load the networks

net_size <- 484

ToM <- readRDS("~/CRUST-1/citation_network/theory_of_mind.rds")

small <- sample_smallworld(1, net_size, 2, 0.05)

lattice <- make_lattice(length = net_size, dim = 1, 
                        nei = 3, circular = T, directed = F)

PT <- readRDS("~/CRUST-1/citation_network/prospect_theory.rds")

small <- sample_smallworld(1, net_size, 3, 0.05)

scalefree <- sample_pa(net_size, directed = F, m = 3)


##INIT. VECTORS

#name

name <- c("Lattice", "Small", "Scale-free" ,"PT", "ToM")

#length

length <- c(length(V(lattice)), length(V(small)), length(V(scalefree)), length(V(PT)), length(V(ToM)))

#max degree
max_degree <- c(max(degree(lattice)), max(degree(small)), max(degree(scalefree)), max(degree(PT)), max(degree(ToM)))

#average degree
mean_degree <- c(mean(degree(lattice)), mean(degree(small)), 
                 mean(degree(scalefree)), mean(degree(PT)), mean(degree(ToM)))

#median degree
median_degree <- c(median(degree(lattice)), median(degree(small)), 
                   median(degree(scalefree)), median(degree(PT)), median(degree(ToM)))

#average path length
avg_path_length <- c(average.path.length(lattice), average.path.length(small), 
                     average.path.length(scalefree), average.path.length(PT), average.path.length(ToM))


#combining the vectors to data
networks <- data.frame(name, length, max_degree, mean_degree, median_degree, avg_path_length)

```

For PT (with net_size 413)

```{r}
##Load the networks

net_size <- 413

ToM <- readRDS("~/CRUST-1/citation_network/theory_of_mind.rds")

small <- sample_smallworld(1, net_size, 2, 0.05)

lattice <- make_lattice(length = net_size, dim = 1, 
                        nei = 3, circular = T, directed = F)

PT <- readRDS("~/CRUST-1/citation_network/prospect_theory.rds")

small <- sample_smallworld(1, net_size, 3, 0.05)

scalefree <- sample_pa(net_size, directed = F, m = 3)


##INIT. VECTORS

#name

name <- c("Lattice", "Small", "Scale-free" ,"PT", "ToM")

#length

length <- c(length(V(lattice)), length(V(small)), length(V(scalefree)), length(V(PT)), length(V(ToM)))

#max degree
max_degree <- c(max(degree(lattice)), max(degree(small)), max(degree(scalefree)), max(degree(PT)), max(degree(ToM)))

#average degree
mean_degree <- c(mean(degree(lattice)), mean(degree(small)), 
                 mean(degree(scalefree)), mean(degree(PT)), mean(degree(ToM)))

#median degree
median_degree <- c(median(degree(lattice)), median(degree(small)), 
                   median(degree(scalefree)), median(degree(PT)), median(degree(ToM)))

#average path length
avg_path_length <- c(average.path.length(lattice), average.path.length(small), 
                     average.path.length(scalefree), average.path.length(PT), average.path.length(ToM))


#combining the vectors to data
networks <- data.frame(name, length, max_degree, mean_degree, median_degree, avg_path_length)

```

