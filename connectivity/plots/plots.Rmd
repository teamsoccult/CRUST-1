---
title: "plots"
author: "Victor MÃ¸ller"
date: "15 maj 2019"
output: html_document
---

network: small-world
sigma: 0.2
comparison: AIC
populations: all
plots: proportion over time 

```{r}

#small world varying population
sm_bo_02_AIC <- read.csv("data/outputs/small_bo_sigma02_AIC.csv", sep = ";")
sm_epi_02_AIC <- read.csv("data/outputs/small_epi_sigma02_AIC.csv", sep = ";")
sm_mave_02_AIC <- read.csv("data/outputs/small_mave_sigma02_AIC.csv", sep = ";")
sm_tess_02_AIC <- read.csv("data/outputs/small_tess_sigma02_AIC.csv", sep = ";")

#easier to work with
bo_02_sub <- sm_bo_02_AIC[seq(1, nrow(sm_bo_02_AIC), 25), ]
epi_02_sub <- sm_epi_02_AIC[seq(1, nrow(sm_epi_02_AIC), 25), ]
mave_02_sub <- sm_mave_02_AIC[seq(1, nrow(sm_mave_02_AIC), 25), ]
tess_02_sub <- sm_tess_02_AIC[seq(1, nrow(sm_tess_02_AIC), 25), ]

#method = gam is fine (gam is default > 1,000 steps)
bo <- ggplot(bo_02_sub, aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  theme(legend.position = "none") +
  labs(title = "Bo") +
  geom_hline(aes(yintercept = 0.5), color = "red", linetype = "dashed", size = 1)

epi <- ggplot(epi_02_sub, aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  theme(legend.position = "none") +
  labs(title = "Epist") +
  geom_hline(aes(yintercept = 0.5), color = "red", linetype = "dashed", size = 1)

mave <- ggplot(mave_02_sub, aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  theme(legend.position = "none") +
  labs(title = "Mave") +
  geom_hline(aes(yintercept = 0.5), color = "red", linetype = "dashed", size = 1)

tess <- ggplot(tess_02_sub, aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  theme(legend.position = "none") +
  labs(title = "Tess") +
  geom_hline(aes(yintercept = 0.5), color = "red", linetype = "dashed", size = 1)

library(cowplot)
allpop <- plot_grid(tess, bo, mave, epi)
allpop

```

network: all
sigma: 0.2
comparison: AIC 
populations: epistemic
plots: proportion over time 

```{r}
#AIC for all 
lat_AIC <- read.csv("data/outputs/lattice_epi_sigma02_AIC.csv", sep = ";")
sca_AIC <- read.csv("data/outputs/scalefree_epi_sigma02_AIC.csv", sep = ";")
sma_AIC <- read.csv("data/outputs/small_epi_sigma02_AIC.csv", sep = ";")

#easier to work with
lat_AIC_subset <- lat_AIC[seq(1, nrow(lat_AIC), 25), ]
sca_AIC_subset <- sca_AIC[seq(1, nrow(sca_AIC), 25), ]
sma_AIC_subset <- sma_AIC[seq(1, nrow(sma_AIC), 25), ]

#lattice
g_lat_AIC <- ggplot(lat_AIC_subset, aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  theme(legend.position="none") +
  labs(title = "lattice") +
  geom_hline(aes(yintercept = 0.5), color = "red", linetype = "dashed", size = 1)

g_lat_AIC
#scale free
g_sca_AIC <- ggplot(sca_AIC_subset, aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  theme(legend.position="none") +
  labs(title = "scale free") +
  geom_hline(aes(yintercept = 0.5), color = "red", linetype = "dashed", size = 1)

g_sca_AIC
#small world
g_sma_AIC <- ggplot(sma_AIC_subset, aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  theme(legend.position="none") +
  labs(title = "small world") +
  geom_hline(aes(yintercept = 0.5), color = "red", linetype = "dashed", size = 1)

g_sma_AIC
#together 
g_AIC <- plot_grid(g_lat_AIC, g_sca_AIC, g_sma_AIC)
g_AIC

```

network: all
sigma: 0.2
comparison: BIC
populations: epistemic
plots: proportion over time 

```{r}
#AIC for all 
lat_BIC <- read.csv("data/outputs/lattice_epi_sigma02_BIC.csv", sep = ";")
sca_BIC <- read.csv("data/outputs/scalefree_epi_sigma02_BIC.csv", sep = ";")
sma_BIC <- read.csv("data/outputs/small_epi_sigma02_BIC.csv", sep = ";")

#easier to work with
lat_BIC_subset <- lat_BIC[seq(1, nrow(lat_BIC), 25), ]
sca_BIC_subset <- sca_BIC[seq(1, nrow(sca_BIC), 25), ]
sma_BIC_subset <- sma_BIC[seq(1, nrow(sma_BIC), 25), ]

#lattice
g_lat_BIC <- ggplot(lat_BIC_subset, aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  theme(legend.position="none") +
  labs(title = "lattice") +
  geom_hline(aes(yintercept = 0.5), color = "red", linetype = "dashed", size = 1)

g_lat_BIC
#scale free
g_sca_BIC <- ggplot(sca_BIC_subset, aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  theme(legend.position="none") +
  labs(title = "scale free") +
  geom_hline(aes(yintercept = 0.5), color = "red", linetype = "dashed", size = 1)

g_sca_BIC
#small world
g_sma_BIC <- ggplot(sma_BIC_subset, aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  theme(legend.position="none") +
  labs(title = "small world") +
  geom_hline(aes(yintercept = 0.5), color = "red", linetype = "dashed", size = 1)

g_sma_BIC
#together 
g_BIC <- plot_grid(g_lat_BIC, g_sca_BIC, g_sma_BIC)
g_BIC
```

network: small world 
sigma: 0.2 & 0.8
comparison: AIC & BIC
populations: epistemic
plots: proportion over time 

```{r}
#loading networks 
BIC_02 <- read.csv("data/outputs/small_epi_sigma02_BIC.csv", sep = ";")
AIC_02 <- read.csv("data/outputs/small_epi_sigma02_AIC.csv", sep = ";")
BIC_08 <- read.csv("data/outputs/small_epi_sigma08_BIC.csv", sep = ";")
AIC_08 <- read.csv("data/outputs/small_epi_sigma08_AIC.csv", sep = ";")

#subsetting 
BIC_02_subset <- BIC_02[seq(1, nrow(BIC_02), 25), ]
AIC_02_subset <- AIC_02[seq(1, nrow(AIC_02), 25), ]
BIC_08_subset <- BIC_08[seq(1, nrow(BIC_08), 25), ]
AIC_08_subset <- AIC_08[seq(1, nrow(AIC_08), 25), ]

#indexing
BIC_02_subset <- BIC_02_subset %>%
  mutate(index = "BIC 02")

AIC_02_subset <- AIC_02_subset %>%
  mutate(index = "AIC_02_subset")

BIC_08_subset <- BIC_08_subset %>%
  mutate(index = "BIC_08_subset")

AIC_08_subset <- AIC_08_subset %>%
  mutate(index = "AIC_08_subset")

#putting together 
criterions_noise <- rbind(BIC_02_subset, AIC_02_subset, BIC_08_subset, AIC_08_subset)

#plotting 
crit_noise <- ggplot(criterions_noise, 
                     aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  theme(legend.position="none") +
  labs(title = "small world") +
  geom_hline(aes(yintercept = 0.5), 
             color = "red", linetype = "dashed", size = 1) +
  facet_wrap(~ index)
  
crit_noise
```

sigma 0.5 
crit: AIC & BIC

```{r}
#loading networks 
BIC_05 <- read.csv("data/outputs/small_epi_sigma05_BIC.csv", sep = ";")
AIC_05 <- read.csv("data/outputs/small_epi_sigma05_AIC.csv", sep = ";")


#subsetting 
BIC_05_subset <- BIC_05[seq(1, nrow(BIC_05), 25), ]
AIC_05_subset <- AIC_05[seq(1, nrow(AIC_05), 25), ]

#indexing
library(tidyverse)
BIC_05_subset <- BIC_05_subset %>%
  mutate(index = "BIC")

AIC_05_subset <- AIC_05_subset %>%
  mutate(index = "AIC")

AIC_BIC_05 <- rbind(AIC_05_subset, BIC_05_subset)

#plotting 
gAIC_BIC_05 <- ggplot(AIC_BIC_05, 
                     aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  labs(title = "small world") +
  geom_hline(aes(yintercept = 0.5), 
             color = "red", linetype = "dashed", size = 1) +
  facet_wrap(~ index)

gAIC_BIC_05
```

BIC
sigma: 0.2, 0.5, 0.8

```{r}
#loading networks 
BIC_02 <- read.csv("data/outputs/small_epi_sigma02_BIC.csv", sep = ";")
BIC_05 <- read.csv("data/outputs/small_epi_sigma05_BIC.csv", sep = ";")
BIC_08 <- read.csv("data/outputs/small_epi_sigma08_BIC.csv", sep = ";")

#subsetting 
BIC_02_subset <- BIC_02[seq(1, nrow(BIC_02), 25), ]
BIC_05_subset <- BIC_05[seq(1, nrow(BIC_05), 25), ]
BIC_08_subset <- BIC_08[seq(1, nrow(BIC_08), 25), ]

#indexing
BIC_02_subset <- BIC_02_subset %>%
  mutate(index = "BIC02")

BIC_05_subset <- BIC_05_subset %>%
  mutate(index = "BIC05")

BIC_08_subset <- BIC_08_subset %>%
  mutate(index = "BIC08")

BIC_sigma <- rbind(BIC_02_subset, BIC_05_subset, BIC_08_subset)

#plotting 
gBIC_sigma <- ggplot(BIC_sigma, 
                     aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  labs(title = "small world") +
  geom_hline(aes(yintercept = 0.5), 
             color = "red", linetype = "dashed", size = 1) +
  facet_wrap(~ index)

gBIC_sigma
```

Checking "hard".
Check up on how they do it. 

```{r}

#loading networks 
soft <- read.csv("data/outputs/small_epi_sigma02_AIC.csv", sep = ";")
hard <- read.csv("data/small_epi_0.2_AIC_100_hard.csv", sep = ";") 

#subsetting 
soft <- soft[seq(1, nrow(soft), 25), ]
hard <- hard[seq(1, nrow(hard), 25), ]

#indexing
soft <- soft %>%
  mutate(index = "soft")

hard <- hard %>%
  mutate(index = "hard")

softhard <- rbind(soft, hard)

#plotting 
g_softhard <- ggplot(softhard, 
                     aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  labs(title = "small world") +
  geom_hline(aes(yintercept = 0.5), 
             color = "red", linetype = "dashed", size = 1) +
  facet_wrap(~ index)

g_softhard

```

checking sample size = 20 

```{r}

#reading
small <- read.csv("data/small_epi_0.2_AIC_100_soft_20.csv", sep = ";")
big <- read.csv("data/outputs/small_epi_sigma02_AIC.csv", sep = ";")

#subsetting 
small <- small[seq(1, nrow(small), 25), ]
big <- big[seq(1, nrow(big), 25), ]

#indexing
small <- small %>%
  mutate(index = "small")

big <- big %>%
  mutate(index = "big")

smallbig <- rbind(small, big)

#plotting 
g_smallbig <- ggplot(smallbig, 
                     aes(timestep, proportion, color = true_model)) +
  geom_point(aes(alpha = 0.1)) +
  geom_smooth() +
  labs(title = "small world") +
  geom_hline(aes(yintercept = 0.5), 
             color = "red", linetype = "dashed", size = 1) +
  facet_wrap(~ index)

g_smallbig

```

testing new K 

```{r}

small <- read.csv("data/small_bo_0.5_BIC_100_hard_100.csv", sep = ";")
lattice <- read.csv("data/lattice_epi_0.2_BIC_100_hard_100.csv", sep = ";")

library(tidyverse)

naming <- colnames(lattice)

library(reshape2)
melt_qual_data <- melt(lattice, id = c(naming[1:24], naming[39:47]))

colored_plot_qual <- ggplot(melt_qual_data, aes(timestep, value, color = variable))+
  geom_point(alpha = 0.01) +
  geom_smooth(alpha = 0.01) +
  geom_hline(aes(yintercept = 0.5), color = "red", linetype = "dashed", size = 1)

colored_plot_qual

```

